{% extends "indberetning/base.html"%}
{% load i18n %}
{% block alert %}
    {% if messages %}
        {% for message in messages %}
        <div class="alert text-center {% if message.level == 20 %}alert-info
                                  {% elif message.level == 25 %}alert-success
                                  {% elif message.level == 30 %}alert-warning
                                  {% elif message.level == 40 %}alert-danger
                                  {% endif %}" role="alert">
            {{ message }}
        </div>
        {% endfor %}
    {% endif %}
{% endblock %}
{% block content %}
<h1>Tidligere indberetninger</h1>

{% for indberetning in object_list %}
{% with skematype_id=indberetning.skematype.id %}


<div class="table-bordered p-3">

<div class="table-responsive col-12">
    <table class="table table-sm">
        <tbody>
        <tr>
            <th class="col-2">{% translate 'Dato'%}</th>
            <td class="col-4">{{indberetning.indberetningstidspunkt|date:"SHORT_DATE_FORMAT"}}</td>
            <td class="col-6">
                <a href="{% url 'indberetning:indberetning-edit' indberetning.uuid %}" class="btn btn-sm btn-secondary">{% translate 'Justér indberetning'%}</a>
            </td>
        </tr>
        <tr>
            <th>{% translate 'Indberetter CPR'%}</th>
            <td>{{indberetning.indberetters_cpr}}</td>
            <td rowspan="3">
                <strong class="mr-2">{% translate 'Eksisterende bilag:'%}</strong>
                {% for bilag in indberetning.bilag.all %}
                <a class="mr-2" href="{% url 'indberetning:bilag-download' pk=bilag.uuid%}">{{bilag.filename}}</a>
                {% endfor %}
            </td>
        </tr>
        <tr>
            <th>{% translate 'Skematype'%}</th>
            <td>{{indberetning.skematype}}</td>
        </tr>
        <tr>
            <th>{% translate 'Total beregnet afgift (kr)' %}</th>
            <td>{{ indberetning.afgift_sum|default_if_none:'' }}</td>
        </tr>
        </tbody>
    </table>
</div>

<div class="table-responsive col-12">
    <table class="table text-center table-sm">
        <thead>
        <tr>
            {% if skematype_id == 1 %}
            <th class="col-2">{% translate 'Fartøjs navn '%}</th>
            {% endif %}
            {% if skematype_id == 2 %}
            <th class="col-1">{% translate 'Fartøjs navn '%}</th>
            <th class="col-1">{% translate 'Indhandlingssted '%}</th>
            {% endif %}
            {% if skematype_id == 3 %}
            <th class="col-2">{% translate 'Indhandlingssted '%}</th>
            {% endif %}
            <th class="col-2">{% translate 'Produkttype'%}</th>
            <th class="col-1">{% translate 'Salgsvægt (kg)'%}</th>
            <th class="col-1">{% translate 'Levende vægt (kg)'%}</th>
            <th class="col-2">{% translate 'Salgspris (kr)'%}</th>
            {% if skematype_id == 1 %}
            <th class="col-1">{% translate 'Transporttillæg (kr)'%}</th>
            {% elif skematype_id == 2 or skematype_id == 3 %}
            <th class="col-1">{% translate 'Bonus og andet vederlag (kr)'%}</th>
            {% endif %}
            <th class="col-1">{% translate 'Afgift (kr)' %}</th>
        </tr>
        </thead>
        <tbody>
        {% for object in indberetning.linjer.all %}
        <tr>
            {% if skematype_id == 1 or skematype_id == 2 %}
            <td>{{ object.fartøj_navn }}</td>
            {% endif %}
            {% if skematype_id == 2 or skematype_id == 3 %}
            <td>{{ object.indhandlingssted }}</td>
            {% endif %}
            <td>{{ object.produkttype }}</td>
            <td>{{ object.salgsvægt }}</td>
            <td>{{ object.levende_vægt }}</td>
            <td>{{ object.salgspris|default_if_none:'' }}</td>
            {% if skematype_id == 1 %}
            <td>{{ object.transporttillæg|default_if_none:'' }}</td>
            {% elif skematype_id == 2 or skematype_id == 3 %}
            <td>{{ object.bonus|default_if_none:'' }}</td>
            {% endif %}
            <td>{{ object.afgift }}</td>
        </tr>
        {% endfor %}
        </tbody>
    </table>
</div>
</div>
{% endwith %}
{% endfor %}

<div class="row justify-content-center">
    <form class="form-inline" method="POST" action="{% url 'indberetning:type-select'%}">
        {% csrf_token %}
        <input class="btn btn-sm btn-success" type="submit" value="{% translate 'Opret ny indberetning'%}">
    </form>
</div>
{% endblock %}
